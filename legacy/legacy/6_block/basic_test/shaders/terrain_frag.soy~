#version 330 core
out vec4 fragCol;
in vec3 outPos;
in vec3 outModel;
in vec2 outUV;
in vec3 outNormal;
in vec3 outColour;
flat in int outSelected;
flat in uint outType;

uniform float worldTime;

uniform int debugCol;
uniform int debugRender;

const vec3 COLS[5] = vec3[5](
  vec3(1.0, 1.0, 1.0),
  vec3(1.0, 0.0, 0.0),
  vec3(0.0, 1.0, 0.0),
  vec3(0.0, 0.0, 1.0),
  vec3(1.0, 1.0, 0.0)
);

void main() {
  float t = worldTime*0.01;
  float light = dot(normalize(vec3(0.0, sin(t), cos(t))), normalize(outNormal));
  vec3 col = vec3(float(outType)/255.0, 1.0 - float(outType)/255.0, 0.5);
  
  if(debugCol == 3 || debugCol == 4) {
    col = COLS[3];
    col *= max(light, 0.1);
  }

  if(debugRender == 0) {
    if(debugCol == 0) {
      col *= max(light, 0.1);
    }
    if(outSelected != 0) {
      col *= 2.0;
    } 
    fragCol = vec4(col, 1.0);
  } else {
    fragCol = vec4(outNormal + 0.5, 1.0);
  }
  fragCol += vec4(outColour, 0.0);
};

