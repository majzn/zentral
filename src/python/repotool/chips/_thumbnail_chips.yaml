name: group_betting_field_thumbnail_chips
type: group
width: 350
height: 964

transform:
  position: [237, 300]

component: true
component-name: chip_coloring
component-properties:
  value_state: "bet_key_value"
  color_state: "state_chip_color"
  multipliers_values: "button_x_value"
  size_of_keys: "192"
  max_num_of_multipliers: "9"
  search_scope_first: "true"
  plugin_update_callback: "callback_cc_thumbnail_0"
  plugin_refresh_callback: "callback_refresh_thumbnail_0"
  ignore_grey_chips: "true"
  rectangles_enabled: "false" # if using rectangles
  tag_to_search_for: "tab_chip_tag_"
  tag_image_face: "tab_face_"
  chip_selected_property: "not_used"
  use_custom_chip_graphics: "true"

children:
  - name: group_chips
    type: group
    width: 350
    height: 964

    children:
      - type: iterator
        start: 0
        end: 192
        index-name: key
        constants:
          sm_prop: bet_key_positions_tb
        template:
          - name: ${grp_el}
            type: group

            transform:
              scale: [0.6, 0.6, 1]

            constants:
              grp_el: group_chips_$key
              x_array: $key * 2
              y_array: $key * 2 + 1

            events:
              - event-name: ANIMATE_CHIPS_TO_COUNTER_EVENT
                event-target-name: ani_chips_collect
                event-target-type: EVENT_TARGET_ANIMATION
                callback: animation_start

              - event-name: ANIMATE_CHIPS_TRANSPARENCY
                event-target-name: chip_alpha_transparency_event
                event-target-type: EVENT_TARGET_ANIMATION
                callback: animation_start

            state-links:
              - name: state_link_x
                state-link-description: "link for x position"
                state-state-machine-source-property-name: ${sm_prop}
                state-state-machine-source-property-index: ${x_array}
                state-source-property: SOURCE_STATEMACHINE_PROPERTY_INT
                state-target-entity-name: ${grp_el}
                state-target-property: TARGET_ENTITY_POSITION_X
                state-link-initial-state: UPDATE_ONCE

              - name: state_link_y
                state-link-description: "link for y position"
                state-state-machine-source-property-name: ${sm_prop}
                state-state-machine-source-property-index: ${y_array}
                state-source-property: SOURCE_STATEMACHINE_PROPERTY_INT
                state-target-entity-name: ${grp_el}
                state-target-property: TARGET_ENTITY_POSITION_Y
                state-link-initial-state: UPDATE_ONCE

            stateful-transitions:
              - condition: bet_key_value[$key] > 0
                update-on-start: true
                scenario-in: chip_alpha_up

              - condition: bet_key_value[$key] == 0 and game_status == 0
                update-on-start: true
                scenario-in: chip_alpha_down

              - condition: bet_key_value[$key] == 0 and game_status == 1
                update-on-start: true
                scenario-in: chip_alpha_down

              - condition: bet_key_value[$key] == 0 and game_status == 2
                update-on-start: true
                scenario-in: chip_losing_animation

              - condition: game_status == 0
                update-on-start: true
                scenario-in: stop_all_anims

              #
              - condition: bet_key_value[3] > 0 and game_status != 2
                update-on-start: true
                context: $key==7 and $G_IS_SINGLE_ZERO
                scenario-in: zero_field_offset
              - condition: bet_key_value[3] == 0 and game_status != 2
                update-on-start: true
                context: $key==7 and $G_IS_SINGLE_ZERO
                scenario-in: zero_field_normal

              # 0 on double zero
              - condition: (bet_key_value[1] > 0 or bet_key_value[2] > 0) and game_status != 2
                update-on-start: true
                context: $key==7 and $G_IS_DOUBLE_ZERO
                scenario-in: zero_field_offset
              - condition: (bet_key_value[1] == 0 and bet_key_value[2] == 0) and game_status != 2
                update-on-start: true
                context: $key==7 and $G_IS_DOUBLE_ZERO
                scenario-in: zero_field_normal

              # 00
              - condition: (bet_key_value[4] > 0 or bet_key_value[5] > 0) and game_status != 2
                update-on-start: true
                context: $key==6 and $G_IS_DOUBLE_ZERO
                scenario-in: zero_field_offset
              - condition: (bet_key_value[4] == 0 and bet_key_value[5] == 0) and game_status != 2
                update-on-start: true
                context: $key==6 and $G_IS_DOUBLE_ZERO
                scenario-in: zero_field_normal

              # 0/00 split
              - condition: bet_key_value[3] > 0 and game_status != 2
                update-on-start: true
                context: $key==23 and $G_IS_DOUBLE_ZERO
                scenario-in: zero_field_offset
              - condition: bet_key_value[3] == 0 and game_status != 2
                update-on-start: true
                context: $key==23 and $G_IS_DOUBLE_ZERO
                scenario-in: zero_field_normal

              # 0/000 split
              - condition: bet_key_value[7] > 0 and game_status != 2
                update-on-start: true
                context: $key==62 and $G_IS_TRIPLE_ZERO
                scenario-in: zero_field_offset
              - condition: bet_key_value[7] == 0 and game_status != 2
                update-on-start: true
                context: $key==62 and $G_IS_TRIPLE_ZERO
                scenario-in: zero_field_normal

              # 00/000 split
              - condition: bet_key_value[6] > 0 and game_status != 2
                update-on-start: true
                context: $key==54 and $G_IS_TRIPLE_ZERO
                scenario-in: zero_field_offset
              - condition: bet_key_value[6] == 0 and game_status != 2
                update-on-start: true
                context: $key==54 and $G_IS_TRIPLE_ZERO
                scenario-in: zero_field_normal

              # 0/00 split
              - condition: bet_key_value[3] > 0 and game_status != 2
                update-on-start: true
                context: $key==23 and $G_IS_TRIPLE_ZERO
                scenario-in: zero_field_offset
              - condition: bet_key_value[3] == 0 and game_status != 2
                update-on-start: true
                context: $key==23 and $G_IS_TRIPLE_ZERO
                scenario-in: zero_field_normal

              #1-12
              - condition: bet_key_value[32] > 0 and game_status != 2
                update-on-start: true
                context: $key==39 and $G_NOT_SPAIN
                scenario-in: dozens_offset
              - condition: bet_key_value[32] == 0 and game_status != 2
                update-on-start: true
                context: $key==39 and $G_NOT_SPAIN
                scenario-in: dozens_normal

              # 13-24
              - condition: bet_key_value[96] > 0 and game_status != 2
                update-on-start: true
                context: $key==119 and $G_NOT_SPAIN
                scenario-in: dozens_offset
              - condition: bet_key_value[96] == 0 and game_status != 2
                update-on-start: true
                context: $key==119 and $G_NOT_SPAIN
                scenario-in: dozens_normal

              # 25-36
              - condition: bet_key_value[160] > 0 and game_status != 2
                update-on-start: true
                context: $key==167 and $G_NOT_SPAIN
                scenario-in: dozens_offset
              - condition: bet_key_value[160] == 0 and game_status != 2
                update-on-start: true
                context: $key==167 and $G_NOT_SPAIN
                scenario-in: dozens_normal

            animations:
              - name: chip_alpha_up
                animation-fps: 60
                tracks:
                  - track-set-value: group_chip HIDDEN 0 0

              - name: chip_alpha_down
                animation-fps: 60
                tracks:
                  - track-set-value: group_chip HIDDEN 0 1

              - name: chip_alpha_transparency_event
                animation-fps: 60
                tracks:
                  - track-set-value: group_chip ALPHA 0 1
                  - track-set-value: group_chip ALPHA 20 1
                  - track-set-value: group_chip ALPHA 30 1
                  - track-set-value: group_chip ALPHA 40 1
                  - track-set-value: group_chip ALPHA 50 1

              - name: stop_all_anims
                animation-fps: 60
                tracks:
                  - track-call-callback: ani_chips_collect ANIMATION_STOP
                  - track-call-callback: chip_losing_animation ANIMATION_STOP

              - name: ani_chips_collect
                animation-fps: 60
                tracks:
                  - track-easing: group_chip ALPHA LINEAR BEGIN_TO_END 1 0 5 25

              - name: chip_losing_animation
                animation-fps: 60
                animation-delay: 120
                tracks:
                  - track-easing: group_chip POSITION_Y EASE_IN_QUINT CURRENT_TO_END 150 25 0
                  - track-easing: group_chip ALPHA LINEAR BEGIN_TO_END 1 0 15 10
                  - track-set-value: group_chip POSITION_Y 25 0
                  - track-set-value: group_chip ALPHA 25 1
                  - track-set-value: group_chip HIDDEN 25 1

              #zero only
              - name: zero_field_normal
                animation-fps: 60
                tracks:
                  - track-set-value: group_chip POSITION_Y 0 $G_ZERO_CHIP_Y_TB_NORMAL
                  - track-call-callback: zero_field_offset ANIMATION_STOP

              - name: zero_field_offset
                animation-fps: 60
                tracks:
                  - track-set-value: group_chip POSITION_Y 0 $G_ZERO_CHIP_Y_TB_OFFSET
                  - track-call-callback: zero_field_normal ANIMATION_STOP

              #1-12 13-24 25-36
              - name: dozens_normal
                animation-fps: 60
                tracks:
                  - track-set-value: group_chip POSITION_X 0 $G_DOZENS_CHIP_X_TB_NORMAL
                  - track-call-callback: dozens_offset ANIMATION_STOP

              - name: dozens_offset
                animation-fps: 60
                tracks:
                  - track-set-value: group_chip POSITION_X 0 $G_DOZENS_CHIP_X_TB_OFFSET
                  - track-call-callback: dozens_normal ANIMATION_STOP

            children:
              - name: group_chip
                type: group

                width: 256
                height: 256

                transform:
                  anchor: ANCHOR_MIDDLE_CENTER
                  alignment: ALIGNMENT_MIDDLE_CENTER
                  scale: [0.4, 0.4, 1]
                  alpha: 0

                children:
                  - name: image_bg_$key
                    type: image
                    image-color-animation: true
                    color: "#000000"
                    atlas: global
                    src: chip/chip_overlay.png
                    src-root: assets/images/
                    transform:
                      anchor: ANCHOR_MIDDLE_CENTER
                      alignment: ALIGNMENT_MIDDLE_CENTER
                      position: [0, 0]
                    tags:
                      - tab_chip_tag_$key

                  - name: image_chip_$key
                    type: image
                    atlas: global
                    src: chip/chip_base.png
                    src-root: assets/images/
                    transform:
                      anchor: ANCHOR_MIDDLE_CENTER
                      alignment: ALIGNMENT_MIDDLE_CENTER
                      position: [0, 0]
                    tags:
                      - tab_face_$key